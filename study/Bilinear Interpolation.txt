Bilinear Interpolation

2차원 좌표상에서 두 좌표가 주어졌을때 중간에 있는 값을 추정하는 방법
샘플 포인트가 정확히 픽셀 위에 위치하지 않을 경우, 해당 위치에서 값을 얻기 위해서 Bilinear Interpolation을 사용함
샘플 포인트가 (2.3, 3.7) 같이 소수점 좌표에 위치할 수 있음. 그래서 주변 네개 픽셀 값을 사용해 중간 값을 계산함

샘플포인트는 셀의 중앙을 기준으로 상하 좌우로 약간씩 이동한 위치에 4개가 있게된다
​예를 들어, 셀의 (0.25, 0.25), (0.75, 0.25), (0.25, 0.75), (0.75, 0.75) 위치에 샘플 포인트가 있을 수 있다

공식은 아래 참조
https://herbwood.tistory.com/20

Q(x,y) = (1−(x−x1))(1−(y−y1))Q11​ + (x−x1)(1−(y−y1))Q21 + (1−(x−x1))(y−y1)Q12​ + (x−x1)(y−y1)Q22

x1, y1 는 샘플 포인트의 하한값, x2, y2 는 샘플 포인트의 상한값

각 샘플 포인트가 있고 각 샘플 포인트에서 보간된 값을 𝑄1, 𝑄2, 𝑄3, 𝑄4 라고 한다면
그 셀의 최종값은 1/4​( 𝑄1​ +𝑄2​ +𝑄3​ +𝑄4​ )

ex) 
어떤 샘플 포인트가 (2.3, 3.7) 좌표에 위치하고 있다면
각각 𝑄11 = (2,3) / 𝑄12 = (2,4) / 𝑄21 = (3,3) / 𝑄22 = (3,4) 에 위치함
각 값을 가지고 있는 주변 네 픽셀들을 이용해서 샘플 포인트의 값을 구함
각 픽셀의 값이 𝑄11 = 10 / 𝑄12 = 20 / 𝑄21 = 30 / 𝑄22 = 40 이라고 가정한다
이 수치들을 위 수식에 대입해보면

1−(x−x1) = 1−(2.3−2) = 0.7
x−x1 = 2.3−2 = 0.3
1−(y−y1) = 1−(3.7−3) = 0.3
​y−y1 = 3.7−3 = 0.7

Q(2.3,3.7) = 0.7⋅0.3⋅10 + 0.3⋅0.3⋅30 + 0.7⋅0.7⋅20 + 0.3⋅0.7⋅40
𝑄(2.3,3.7) = 2.1 + 2.7 + 9.8 + 8.4 = 23

이렇게 보간된 값을 각 샘플 포인트에서 얻고 이 값들을 이용해 셀을 채운다.
Mask R-CNN에서는 Maxpooling방식을 사용해서 가장 높은 샘플 포인트 값으로 셀을 채운다

